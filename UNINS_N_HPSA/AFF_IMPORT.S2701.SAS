/* The data was pulled from American FactFinder. The downloads were separated into a Part 1 and Part 2 because there are 72,000 Census Tracts but American FactFinder only allows 50,000 Geographic Areas to be downloaded per request. */
/* http://factfinder.census.gov/bkmk/table/1.0/en/ACS/14_5YR/S2701/0400000US01.14000|0400000US02.14000|0400000US04.14000|0400000US05.14000|0400000US06.14000|0400000US08.14000|0400000US09.14000|0400000US10.14000|0400000US11.14000|0400000US12.14000|0400000US13.14000|0400000US15.14000|0400000US16.14000|0400000US17.14000|0400000US18.14000|0400000US19.14000|0400000US20.14000|0400000US21.14000|0400000US22.14000|0400000US23.14000|0400000US24.14000|0400000US25.14000|0400000US26.14000|0400000US27.14000|0400000US28.14000 */
/* http://factfinder.census.gov/bkmk/table/1.0/en/ACS/14_5YR/S2701/0400000US29.14000|0400000US30.14000|0400000US31.14000|0400000US32.14000|0400000US33.14000|0400000US34.14000|0400000US35.14000|0400000US36.14000|0400000US37.14000|0400000US38.14000|0400000US39.14000|0400000US40.14000|0400000US41.14000|0400000US42.14000|0400000US44.14000|0400000US45.14000|0400000US46.14000|0400000US47.14000|0400000US48.14000|0400000US49.14000|0400000US50.14000|0400000US51.14000|0400000US53.14000|0400000US54.14000|0400000US55.14000|0400000US56.14000|0400000US72.14000 */

%LET AFF=/Directory/;
LIBNAME AFF "&AFF.";

%MACRO S2701(PART);
OPTIONS ERRORS=0;
FILENAME S2701_P&PART. "&AFF.ACS_14_5YR_S2701_P&PART..csv" LRECL=3100;
DATA PART&PART.;
	INFILE S2701_P&PART. DLM="," DSD FIRSTOBS=2;
	LENGTH GEOID2 $21. GEOID $11. NAME $100.;
	INPUT GEOID2 $ GEOID $ NAME $ HC01_EST_VC01 HC01_MOE_VC01 HC02_EST_VC01 HC02_MOE_VC01 HC03_EST_VC01 HC03_MOE_VC01 HC04_EST_VC01 HC04_MOE_VC01 HC05_EST_VC01 HC05_MOE_VC01
		HC01_EST_VC04 HC01_MOE_VC04 HC02_EST_VC04 HC02_MOE_VC04 HC03_EST_VC04 HC03_MOE_VC04 HC04_EST_VC04 HC04_MOE_VC04 HC05_EST_VC04 HC05_MOE_VC04 HC01_EST_VC05 HC01_MOE_VC05 HC02_EST_VC05 HC02_MOE_VC05 HC03_EST_VC05 HC03_MOE_VC05 HC04_EST_VC05 HC04_MOE_VC05 HC05_EST_VC05 HC05_MOE_VC05 HC01_EST_VC06 HC01_MOE_VC06 HC02_EST_VC06 HC02_MOE_VC06 HC03_EST_VC06 HC03_MOE_VC06 HC04_EST_VC06 HC04_MOE_VC06 HC05_EST_VC06 HC05_MOE_VC06 HC01_EST_VC08 HC01_MOE_VC08 HC02_EST_VC08 HC02_MOE_VC08 HC03_EST_VC08 HC03_MOE_VC08 HC04_EST_VC08 HC04_MOE_VC08 HC05_EST_VC08 HC05_MOE_VC08 HC01_EST_VC11 HC01_MOE_VC11 HC02_EST_VC11 HC02_MOE_VC11 HC03_EST_VC11 HC03_MOE_VC11 HC04_EST_VC11 HC04_MOE_VC11 HC05_EST_VC11 HC05_MOE_VC11 HC01_EST_VC12 HC01_MOE_VC12 HC02_EST_VC12 HC02_MOE_VC12 HC03_EST_VC12 HC03_MOE_VC12 HC04_EST_VC12 HC04_MOE_VC12 HC05_EST_VC12 HC05_MOE_VC12
		HC01_EST_VC15 HC01_MOE_VC15 HC02_EST_VC15 HC02_MOE_VC15 HC03_EST_VC15 HC03_MOE_VC15 HC04_EST_VC15 HC04_MOE_VC15 HC05_EST_VC15 HC05_MOE_VC15 HC01_EST_VC16 HC01_MOE_VC16 HC02_EST_VC16 HC02_MOE_VC16 HC03_EST_VC16 HC03_MOE_VC16 HC04_EST_VC16 HC04_MOE_VC16 HC05_EST_VC16 HC05_MOE_VC16 HC01_EST_VC17 HC01_MOE_VC17 HC02_EST_VC17 HC02_MOE_VC17 HC03_EST_VC17 HC03_MOE_VC17 HC04_EST_VC17 HC04_MOE_VC17 HC05_EST_VC17 HC05_MOE_VC17 HC01_EST_VC18 HC01_MOE_VC18 HC02_EST_VC18 HC02_MOE_VC18 HC03_EST_VC18 HC03_MOE_VC18 HC04_EST_VC18 HC04_MOE_VC18 HC05_EST_VC18 HC05_MOE_VC18 HC01_EST_VC19 HC01_MOE_VC19 HC02_EST_VC19 HC02_MOE_VC19 HC03_EST_VC19 HC03_MOE_VC19 HC04_EST_VC19 HC04_MOE_VC19 HC05_EST_VC19 HC05_MOE_VC19 HC01_EST_VC20 HC01_MOE_VC20 HC02_EST_VC20 HC02_MOE_VC20 HC03_EST_VC20 HC03_MOE_VC20 HC04_EST_VC20 HC04_MOE_VC20 HC05_EST_VC20 HC05_MOE_VC20
		HC01_EST_VC21 HC01_MOE_VC21 HC02_EST_VC21 HC02_MOE_VC21 HC03_EST_VC21 HC03_MOE_VC21 HC04_EST_VC21 HC04_MOE_VC21 HC05_EST_VC21 HC05_MOE_VC21 HC01_EST_VC22 HC01_MOE_VC22 HC02_EST_VC22 HC02_MOE_VC22 HC03_EST_VC22 HC03_MOE_VC22 HC04_EST_VC22 HC04_MOE_VC22 HC05_EST_VC22 HC05_MOE_VC22 HC01_EST_VC24 HC01_MOE_VC24 HC02_EST_VC24 HC02_MOE_VC24 HC03_EST_VC24 HC03_MOE_VC24 HC04_EST_VC24 HC04_MOE_VC24 HC05_EST_VC24 HC05_MOE_VC24 HC01_EST_VC25 HC01_MOE_VC25 HC02_EST_VC25 HC02_MOE_VC25 HC03_EST_VC25 HC03_MOE_VC25 HC04_EST_VC25 HC04_MOE_VC25 HC05_EST_VC25 HC05_MOE_VC25 HC01_EST_VC28 HC01_MOE_VC28 HC02_EST_VC28 HC02_MOE_VC28 HC03_EST_VC28 HC03_MOE_VC28 HC04_EST_VC28 HC04_MOE_VC28 HC05_EST_VC28 HC05_MOE_VC28 HC01_EST_VC29 HC01_MOE_VC29 HC02_EST_VC29 HC02_MOE_VC29 HC03_EST_VC29 HC03_MOE_VC29 HC04_EST_VC29 HC04_MOE_VC29 HC05_EST_VC29 HC05_MOE_VC29
		HC01_EST_VC30 HC01_MOE_VC30 HC02_EST_VC30 HC02_MOE_VC30 HC03_EST_VC30 HC03_MOE_VC30 HC04_EST_VC30 HC04_MOE_VC30 HC05_EST_VC30 HC05_MOE_VC30 HC01_EST_VC31 HC01_MOE_VC31 HC02_EST_VC31 HC02_MOE_VC31 HC03_EST_VC31 HC03_MOE_VC31 HC04_EST_VC31 HC04_MOE_VC31 HC05_EST_VC31 HC05_MOE_VC31 HC01_EST_VC34 HC01_MOE_VC34 HC02_EST_VC34 HC02_MOE_VC34 HC03_EST_VC34 HC03_MOE_VC34 HC04_EST_VC34 HC04_MOE_VC34 HC05_EST_VC34 HC05_MOE_VC34 HC01_EST_VC35 HC01_MOE_VC35 HC02_EST_VC35 HC02_MOE_VC35 HC03_EST_VC35 HC03_MOE_VC35 HC04_EST_VC35 HC04_MOE_VC35 HC05_EST_VC35 HC05_MOE_VC35 HC01_EST_VC36 HC01_MOE_VC36 HC02_EST_VC36 HC02_MOE_VC36 HC03_EST_VC36 HC03_MOE_VC36 HC04_EST_VC36 HC04_MOE_VC36 HC05_EST_VC36 HC05_MOE_VC36 HC01_EST_VC37 HC01_MOE_VC37 HC02_EST_VC37 HC02_MOE_VC37 HC03_EST_VC37 HC03_MOE_VC37 HC04_EST_VC37 HC04_MOE_VC37 HC05_EST_VC37 HC05_MOE_VC37
		HC01_EST_VC38 HC01_MOE_VC38 HC02_EST_VC38 HC02_MOE_VC38 HC03_EST_VC38 HC03_MOE_VC38 HC04_EST_VC38 HC04_MOE_VC38 HC05_EST_VC38 HC05_MOE_VC38 HC01_EST_VC41 HC01_MOE_VC41 HC02_EST_VC41 HC02_MOE_VC41 HC03_EST_VC41 HC03_MOE_VC41 HC04_EST_VC41 HC04_MOE_VC41 HC05_EST_VC41 HC05_MOE_VC41 HC01_EST_VC42 HC01_MOE_VC42 HC02_EST_VC42 HC02_MOE_VC42 HC03_EST_VC42 HC03_MOE_VC42 HC04_EST_VC42 HC04_MOE_VC42 HC05_EST_VC42 HC05_MOE_VC42 HC01_EST_VC43 HC01_MOE_VC43 HC02_EST_VC43 HC02_MOE_VC43 HC03_EST_VC43 HC03_MOE_VC43 HC04_EST_VC43 HC04_MOE_VC43 HC05_EST_VC43 HC05_MOE_VC43 HC01_EST_VC44 HC01_MOE_VC44 HC02_EST_VC44 HC02_MOE_VC44 HC03_EST_VC44 HC03_MOE_VC44 HC04_EST_VC44 HC04_MOE_VC44 HC05_EST_VC44 HC05_MOE_VC44 HC01_EST_VC45 HC01_MOE_VC45 HC02_EST_VC45 HC02_MOE_VC45 HC03_EST_VC45 HC03_MOE_VC45 HC04_EST_VC45 HC04_MOE_VC45 HC05_EST_VC45 HC05_MOE_VC45
		HC01_EST_VC48 HC01_MOE_VC48 HC02_EST_VC48 HC02_MOE_VC48 HC03_EST_VC48 HC03_MOE_VC48 HC04_EST_VC48 HC04_MOE_VC48 HC05_EST_VC48 HC05_MOE_VC48 HC01_EST_VC49 HC01_MOE_VC49 HC02_EST_VC49 HC02_MOE_VC49 HC03_EST_VC49 HC03_MOE_VC49 HC04_EST_VC49 HC04_MOE_VC49 HC05_EST_VC49 HC05_MOE_VC49 HC01_EST_VC50 HC01_MOE_VC50 HC02_EST_VC50 HC02_MOE_VC50 HC03_EST_VC50 HC03_MOE_VC50 HC04_EST_VC50 HC04_MOE_VC50 HC05_EST_VC50 HC05_MOE_VC50 HC01_EST_VC51 HC01_MOE_VC51 HC02_EST_VC51 HC02_MOE_VC51 HC03_EST_VC51 HC03_MOE_VC51 HC04_EST_VC51 HC04_MOE_VC51 HC05_EST_VC51 HC05_MOE_VC51 HC01_EST_VC54 HC01_MOE_VC54 HC02_EST_VC54 HC02_MOE_VC54 HC03_EST_VC54 HC03_MOE_VC54 HC04_EST_VC54 HC04_MOE_VC54 HC05_EST_VC54 HC05_MOE_VC54 HC01_EST_VC55 HC01_MOE_VC55 HC02_EST_VC55 HC02_MOE_VC55 HC03_EST_VC55 HC03_MOE_VC55 HC04_EST_VC55 HC04_MOE_VC55 HC05_EST_VC55 HC05_MOE_VC55
		HC01_EST_VC56 HC01_MOE_VC56 HC02_EST_VC56 HC02_MOE_VC56 HC03_EST_VC56 HC03_MOE_VC56 HC04_EST_VC56 HC04_MOE_VC56 HC05_EST_VC56 HC05_MOE_VC56 HC01_EST_VC57 HC01_MOE_VC57 HC02_EST_VC57 HC02_MOE_VC57 HC03_EST_VC57 HC03_MOE_VC57 HC04_EST_VC57 HC04_MOE_VC57 HC05_EST_VC57 HC05_MOE_VC57 HC01_EST_VC58 HC01_MOE_VC58 HC02_EST_VC58 HC02_MOE_VC58 HC03_EST_VC58 HC03_MOE_VC58 HC04_EST_VC58 HC04_MOE_VC58 HC05_EST_VC58 HC05_MOE_VC58 HC01_EST_VC59 HC01_MOE_VC59 HC02_EST_VC59 HC02_MOE_VC59 HC03_EST_VC59 HC03_MOE_VC59 HC04_EST_VC59 HC04_MOE_VC59 HC05_EST_VC59 HC05_MOE_VC59 HC01_EST_VC62 HC01_MOE_VC62 HC02_EST_VC62 HC02_MOE_VC62 HC03_EST_VC62 HC03_MOE_VC62 HC04_EST_VC62 HC04_MOE_VC62 HC05_EST_VC62 HC05_MOE_VC62 HC01_EST_VC63 HC01_MOE_VC63 HC02_EST_VC63 HC02_MOE_VC63 HC03_EST_VC63 HC03_MOE_VC63 HC04_EST_VC63 HC04_MOE_VC63 HC05_EST_VC63 HC05_MOE_VC63
		HC01_EST_VC64 HC01_MOE_VC64 HC02_EST_VC64 HC02_MOE_VC64 HC03_EST_VC64 HC03_MOE_VC64 HC04_EST_VC64 HC04_MOE_VC64 HC05_EST_VC64 HC05_MOE_VC64 HC01_EST_VC65 HC01_MOE_VC65 HC02_EST_VC65 HC02_MOE_VC65 HC03_EST_VC65 HC03_MOE_VC65 HC04_EST_VC65 HC04_MOE_VC65 HC05_EST_VC65 HC05_MOE_VC65 HC01_EST_VC68 HC01_MOE_VC68 HC02_EST_VC68 HC02_MOE_VC68 HC03_EST_VC68 HC03_MOE_VC68 HC04_EST_VC68 HC04_MOE_VC68 HC05_EST_VC68 HC05_MOE_VC68 HC01_EST_VC69 HC01_MOE_VC69 HC02_EST_VC69 HC02_MOE_VC69 HC03_EST_VC69 HC03_MOE_VC69 HC04_EST_VC69 HC04_MOE_VC69 HC05_EST_VC69 HC05_MOE_VC69 HC01_EST_VC70 HC01_MOE_VC70 HC02_EST_VC70 HC02_MOE_VC70 HC03_EST_VC70 HC03_MOE_VC70 HC04_EST_VC70 HC04_MOE_VC70 HC05_EST_VC70 HC05_MOE_VC70 HC01_EST_VC71 HC01_MOE_VC71 HC02_EST_VC71 HC02_MOE_VC71 HC03_EST_VC71 HC03_MOE_VC71 HC04_EST_VC71 HC04_MOE_VC71 HC05_EST_VC71 HC05_MOE_VC71
		HC01_EST_VC72 HC01_MOE_VC72 HC02_EST_VC72 HC02_MOE_VC72 HC03_EST_VC72 HC03_MOE_VC72 HC04_EST_VC72 HC04_MOE_VC72 HC05_EST_VC72 HC05_MOE_VC72 HC01_EST_VC73 HC01_MOE_VC73 HC02_EST_VC73 HC02_MOE_VC73 HC03_EST_VC73 HC03_MOE_VC73 HC04_EST_VC73 HC04_MOE_VC73 HC05_EST_VC73 HC05_MOE_VC73 HC01_EST_VC74 HC01_MOE_VC74 HC02_EST_VC74 HC02_MOE_VC74 HC03_EST_VC74 HC03_MOE_VC74 HC04_EST_VC74 HC04_MOE_VC74 HC05_EST_VC74 HC05_MOE_VC74 HC01_EST_VC75 HC01_MOE_VC75 HC02_EST_VC75 HC02_MOE_VC75 HC03_EST_VC75 HC03_MOE_VC75 HC04_EST_VC75 HC04_MOE_VC75 HC05_EST_VC75 HC05_MOE_VC75 HC01_EST_VC76 HC01_MOE_VC76 HC02_EST_VC76 HC02_MOE_VC76 HC03_EST_VC76 HC03_MOE_VC76 HC04_EST_VC76 HC04_MOE_VC76 HC05_EST_VC76 HC05_MOE_VC76 HC01_EST_VC77 HC01_MOE_VC77 HC02_EST_VC77 HC02_MOE_VC77 HC03_EST_VC77 HC03_MOE_VC77 HC04_EST_VC77 HC04_MOE_VC77 HC05_EST_VC77 HC05_MOE_VC77
		HC01_EST_VC78 HC01_MOE_VC78 HC02_EST_VC78 HC02_MOE_VC78 HC03_EST_VC78 HC03_MOE_VC78 HC04_EST_VC78 HC04_MOE_VC78 HC05_EST_VC78 HC05_MOE_VC78 HC01_EST_VC79 HC01_MOE_VC79 HC02_EST_VC79 HC02_MOE_VC79 HC03_EST_VC79 HC03_MOE_VC79 HC04_EST_VC79 HC04_MOE_VC79 HC05_EST_VC79 HC05_MOE_VC79 HC01_EST_VC80 HC01_MOE_VC80 HC02_EST_VC80 HC02_MOE_VC80 HC03_EST_VC80 HC03_MOE_VC80 HC04_EST_VC80 HC04_MOE_VC80 HC05_EST_VC80 HC05_MOE_VC80 HC01_EST_VC81 HC01_MOE_VC81 HC02_EST_VC81 HC02_MOE_VC81 HC03_EST_VC81 HC03_MOE_VC81 HC04_EST_VC81 HC04_MOE_VC81 HC05_EST_VC81 HC05_MOE_VC81 HC01_EST_VC82 HC01_MOE_VC82 HC02_EST_VC82 HC02_MOE_VC82 HC03_EST_VC82 HC03_MOE_VC82 HC04_EST_VC82 HC04_MOE_VC82 HC05_EST_VC82 HC05_MOE_VC82 HC01_EST_VC83 HC01_MOE_VC83 HC02_EST_VC83 HC02_MOE_VC83 HC03_EST_VC83 HC03_MOE_VC83 HC04_EST_VC83 HC04_MOE_VC83 HC05_EST_VC83 HC05_MOE_VC83
		HC01_EST_VC84 HC01_MOE_VC84 HC02_EST_VC84 HC02_MOE_VC84 HC03_EST_VC84 HC03_MOE_VC84 HC04_EST_VC84 HC04_MOE_VC84 HC05_EST_VC84 HC05_MOE_VC84 HC01_EST_VC87 HC01_MOE_VC87 HC02_EST_VC87 HC02_MOE_VC87 HC03_EST_VC87 HC03_MOE_VC87 HC04_EST_VC87 HC04_MOE_VC87 HC05_EST_VC87 HC05_MOE_VC87 HC01_EST_VC88 HC01_MOE_VC88 HC02_EST_VC88 HC02_MOE_VC88 HC03_EST_VC88 HC03_MOE_VC88 HC04_EST_VC88 HC04_MOE_VC88 HC05_EST_VC88 HC05_MOE_VC88 HC01_EST_VC89 HC01_MOE_VC89 HC02_EST_VC89 HC02_MOE_VC89 HC03_EST_VC89 HC03_MOE_VC89 HC04_EST_VC89 HC04_MOE_VC89 HC05_EST_VC89 HC05_MOE_VC89 HC01_EST_VC90 HC01_MOE_VC90 HC02_EST_VC90 HC02_MOE_VC90 HC03_EST_VC90 HC03_MOE_VC90 HC04_EST_VC90 HC04_MOE_VC90 HC05_EST_VC90 HC05_MOE_VC90 HC01_EST_VC91 HC01_MOE_VC91 HC02_EST_VC91 HC02_MOE_VC91 HC03_EST_VC91 HC03_MOE_VC91 HC04_EST_VC91 HC04_MOE_VC91 HC05_EST_VC91 HC05_MOE_VC91
		HC01_EST_VC92 HC01_MOE_VC92 HC02_EST_VC92 HC02_MOE_VC92 HC03_EST_VC92 HC03_MOE_VC92 HC04_EST_VC92 HC04_MOE_VC92 HC05_EST_VC92 HC05_MOE_VC92 HC01_EST_VC93 HC01_MOE_VC93 HC02_EST_VC93 HC02_MOE_VC93 HC03_EST_VC93 HC03_MOE_VC93 HC04_EST_VC93 HC04_MOE_VC93 HC05_EST_VC93 HC05_MOE_VC93 HC01_EST_VC94 HC01_MOE_VC94 HC02_EST_VC94 HC02_MOE_VC94 HC03_EST_VC94 HC03_MOE_VC94 HC04_EST_VC94 HC04_MOE_VC94 HC05_EST_VC94 HC05_MOE_VC94 HC01_EST_VC95 HC01_MOE_VC95 HC02_EST_VC95 HC02_MOE_VC95 HC03_EST_VC95 HC03_MOE_VC95 HC04_EST_VC95 HC04_MOE_VC95 HC05_EST_VC95 HC05_MOE_VC95;
	RUN;
OPTIONS ERRORS=200;
%MEND;

%S2701(1);
%S2701(2);

DATA S2701_PRE;
	SET PART1 PART2;
RUN;

PROC MEANS DATA=S2701_PRE NOPRINT;
	VAR _NUMERIC_;
	OUTPUT OUT=S2701_MEANS(WHERE=(_STAT_="MEAN"));
RUN;
PROC TRANSPOSE DATA=S2701_MEANS OUT=S2701_MEANS(WHERE=(COL1 = . OR _NAME_ CONTAINS "MOE" OR _NAME_ CONTAINS "HC03" OR _NAME_ CONTAINS "HC04" OR _NAME_ CONTAINS "HC05"));
RUN;

PROC SQL NOPRINT;
	SELECT _NAME_ INTO: DROPVAR SEPARATED BY " "
	FROM S2701_MEANS;
QUIT;

%PUT &DROPVAR.;

DATA AFF.S2701_140;
	SET S2701_PRE;
	ARRAY FIX(*) _NUMERIC_;
	DO i = 1 TO DIM(FIX);
		IF FIX(i) = . THEN FIX(i) = 0;
	END;
	DROP &DROPVAR. i;
RUN;

%LET UNINS=/Directory/;
FILENAME UNINS "&UNINS.UNINS.DBF";
PROC DBF DATA=AFF.S2701(WHERE=(SUBSTR(GEOID,1,2) = "06" & SUBSTR(GEOID,3,3) IN("037","059"))) DB4=UNINS;
RUN;
